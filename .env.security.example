# Security Configuration for MCP WebScraper
# Copy this file to .env and customize for your environment

# SSRF Protection
SSRF_PROTECTION_ENABLED=true
ALLOWED_PROTOCOLS=http:,https:
MAX_REQUEST_SIZE=104857600
MAX_REQUEST_TIMEOUT=60000
MAX_REDIRECTS=5
ALLOWED_DOMAINS=
BLOCKED_DOMAINS=localhost,127.0.0.1,0.0.0.0,metadata.google.internal,169.254.169.254,metadata.azure.com

# Input Validation
INPUT_VALIDATION_ENABLED=true
MAX_STRING_LENGTH=10000
MAX_ARRAY_LENGTH=1000
MAX_OBJECT_DEPTH=10
MAX_REGEX_LENGTH=500
STRICT_VALIDATION_MODE=false

# API Security
REQUIRE_AUTHENTICATION=false
API_KEY_HEADER=X-API-Key
API_KEY=
RATE_LIMIT_BY_KEY=false
AUDIT_LOGGING=true

# Content Security
SANITIZE_HTML=true
ALLOWED_HTML_TAGS=p,br,strong,em,u,h1,h2,h3,h4,h5,h6
BLOCK_SCRIPTS=true
BLOCK_IFRAMES=true

# Security Monitoring
SECURITY_LOGGING=true
VIOLATION_LOGGING=true
ENABLE_SECURITY_HEADERS=true

# Rate Limiting (Enhanced)
RATE_LIMIT_REQUESTS_PER_SECOND=5
RATE_LIMIT_REQUESTS_PER_MINUTE=50
RATE_LIMIT_PER_DOMAIN=true

# Crawling Security
MAX_CRAWL_DEPTH=3
MAX_PAGES_PER_CRAWL=50
RESPECT_ROBOTS_TXT=true
FOLLOW_EXTERNAL_LINKS=false